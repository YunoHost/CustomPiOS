export BASE_DISTRO=armbian
export BASE_ADD_USER=no
export DIST_NAME=lime2
export DIST_VERSION=0.1.0
if [[ "${BASE_DISTRO}" == "armbian" ]]; then
  # The root partiton of the image filesystem, 2 for raspbian, 1 for armbian
  export BASE_ROOT_PARTITION=1
  export BASE_IMAGE_RASPBIAN=no
  export BASE_IMAGE_ENLARGEROOT=1000
  export BASE_ZIP_IMG=$(ls -t ${DIST_PATH}/image/Armbian_*.{zip,7z,xz,img} | head -n 1)
else
  export BASE_IMAGE_ENLARGEROOT=500
  export BASE_ZIP_IMG=$(ls -t ${DIST_PATH}/image/*-raspios-*.{zip,7z,xz,img} | head -n 1)
fi

export YNH_BUILDER_BRANCH=stable
export YNH_BUILDER_INSTALL_INTERNETCUBE=yes

export MODULES="base(yunohost)"

export BASE_RELEASE_COMPRESS=yes
export BASE_RELEASE_SHA256=yes
export BASE_RELEASE_IMG_NAME="${DIST_NAME}-$(date +%Y%m%d)"
if [[ -f "${BASE_WORKSPACE}/yunohost.tar.gz" ]]; then
    tar xzf "${BASE_WORKSPACE}/yunohost.tar.gz" -C "${BASE_WORKSPACE}" --strip-components=1
    YNH_VERSION=$( <${BASE_WORKSPACE}/yunohost_version)
    BASE_RELEASE_IMG_NAME="${YNH_VERSION}_${BASE_RELEASE_IMG_NAME}"
fi

if [[ "${YNH_BUILDER_INSTALL_INTERNETCUBE}" == "yes" ]]; then
    BASE_RELEASE_IMG_NAME="internetcube_${BASE_RELEASE_IMG_NAME}"
elif [[ "${YNH_BUILDER_INSTALL_CLIC}" == "yes" ]]; then
    BASE_RELEASE_IMG_NAME="clic_${BASE_RELEASE_IMG_NAME}" 
fi
